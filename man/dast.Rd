% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mda_modelling.R
\name{dast}
\alias{dast}
\title{Fitting of decay-adjusted spatio-temporal (DAST) model}
\usage{
dast(
  formula,
  data,
  den = NULL,
  survey_times,
  mda_times,
  int_mat,
  penalty = NULL,
  drop = NULL,
  power_val,
  crs = NULL,
  convert_to_crs = NULL,
  scale_to_km = TRUE,
  control_mcmc = set_control_sim(),
  par0 = NULL,
  S_samples = NULL,
  return_samples = TRUE,
  messages = TRUE,
  start_pars = list(beta = NULL, sigma2 = NULL, tau2 = NULL, phi = NULL, sigma2_re =
    NULL, gamma = NULL, alpha = NULL)
)
}
\arguments{
\item{formula}{A model formula specifying the response variable and predictors.}

\item{data}{A `data.frame` or `sf` object containing the dataset.}

\item{den}{The denominator for binomial models.}

\item{survey_times}{The variable indicating the survey times.}

\item{mda_times}{A vector specifying the mass drug administration (MDA) times.}

\item{int_mat}{Intervention matrix specifying the timing and coverage of MDA; the dimension of the matrix
must be \code{n * n_mda}, where \code{n} is the number of rows of \code{data} and \code{n_mda} is the length of \code{mda_times}.}

\item{penalty}{Optional list specifying penalty functions for regularization, used in the estimation of the "drop" parameter \code{alpha}.}

\item{drop}{Optional value used for fixing the "drop" parameter of the MDA impact function.}

\item{power_val}{Value expressing the power of the MDA impact function.}

\item{crs}{Optional coordinate reference system (CRS) for spatial data.}

\item{convert_to_crs}{CRS to which spatial data should be converted.}

\item{scale_to_km}{Logical; whether to scale distances to kilometers (default: `TRUE`).}

\item{control_mcmc}{A list of MCMC control parameters, typically from `set_control_sim()`.}

\item{par0}{Optional list of initial parameter values.}

\item{S_samples}{Number of posterior samples to retain.}

\item{return_samples}{Logical; whether to return posterior samples (default: `TRUE`).}

\item{messages}{Logical; whether to print messages (default: `TRUE`).}

\item{start_pars}{List of starting values for parameters.}
}
\value{
A list containing model estimates, posterior samples, and metadata.

A list containing:

- `y`: Response variable values.
- `D`: Covariate matrix.
- `coords`: Unique spatial coordinates.
- `mda_times`: MDA time points.
- `survey_times_data`: Survey time data.
- `int_mat`: Intervention matrix.
- `ID_coords`: Indices of spatial locations.
- `re`: Random effects levels (if applicable).
- `ID_re`: Indices of random effects (if applicable).
- `power_val`: Power of the MDA impact function.
- `fix_tau2`: Fixed tau-squared value (if applicable).
- `fix_alpha`: Fixed alpha value (if applicable).
- `formula`: Model formula.
- `crs`: Coordinate reference system.
- `scale_to_km`: Indicator of distance scaling.
- `data_sf`: Processed spatial dataset.
- `family`: Model family (e.g., "binomial").
- `kappa`: Smoothness parameter.
- `units_m`: Denominator for binomial models.
- `cov_offset`: Offset for covariates.
- `call`: Function call.
- `penalty`: Penalty function details (if applicable).
- `posterior_samples`: Posterior samples if `return_samples = TRUE`.
}
\description{
The function fits a decay-adjusted spatio-temporal (DAST) model using Monte Carlo maximum liklihood.
The DAST model allows for the incorporation of the temporal decay in diease prevalence due
to the impact of mass drug administration (MDA). The function requires the full MDA history as detailed in the arguments below.
}
\seealso{
\code{\link{set_control_sim}}, \code{\link{summary.RiskMap}}, \code{\link{to_table}}
}
\author{
Emanuele Giorgi \email{e.giorgi@lancaster.ac.uk}

Claudio Fronterre \email{c.fronterr@lancaster.ac.uk}
}
